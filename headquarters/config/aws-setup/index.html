<!doctype html><html lang=en><head><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-129284684-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=description content><meta name=keywords content="installation,configuration,cloud,aws"><link rel=icon href=/img/favicon/favicon-support-1.png type=image/png sizes=16x16><link rel=icon href=/img/favicon/favicon-support-1-48-win-ico.png type=image/png sizes=48x48><link rel=icon href=/img/favicon/favicon-support-1-158-General-use-iOS-Android.png type=image/png sizes=152x152><link rel=icon href=/img/favicon/favicon-support-1-196-Chrome-for-Android.png type=image/png sizes=196x196><link rel=icon href=/img/favicon/favicon-support-1-558-win10-tile.png type=image/png sizes=558x558><title>AWS setup</title><link rel=stylesheet href=https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css integrity=sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T crossorigin=anonymous><link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700,900&subset=cyrillic,cyrillic-ext,greek,greek-ext,latin-ext,vietnamese" rel=stylesheet><link href=/css/all.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.css rel=stylesheet></head><body><header class="px-md-3 pt-3"><div class=container><div class=row><div class="mb-3 col-lg-6 col-md-12"><a class="navbar-brand text-white pr-0 mr-0 float-left" href=https://mysurvey.solutions/ target=_blank><img src=/img/logo.png alt="Survey Solutions" class=float-left>
<span class="float-left ml-2">Survey<br>Solutions</span></a>
<a class="navbar-text text-white pl-sm-4 ml-sm-4 pl-2 ml-2 float-left" href=https://docs.mysurvey.solutions/>Documentation and knowledge base</a></div><script type=text/template id=my-custom-menu-template>
    <div class="aa">
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="docs-tab" data-toggle="tab" href="#docs" role="tab" aria-controls="docs" aria-selected="true">Articles</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="forum-tab" data-toggle="tab" href="#forum" role="tab" aria-controls="forum" aria-selected="false">Forum topics</a>
            </li>
        </ul>
        <div class="tab-content">
            <div class="aa-dataset-docs tab-pane fade show active" id="docs" role="tabpanel" aria-labelledby="docs-tab"></div>
            <div class="aa-dataset-forum tab-pane fade" id="forum" role="tabpanel" aria-labelledby="forum-tab"></div>
        </div>
    </div>
</script><div class="col-lg-6 col-md-12 pt-2 mb-4 mb-lg-3"><form class=form-inline onsubmit=return!1><div class="input-group search"><input type=text class="form-control w-100" placeholder="Have a Question? Ask or enter a search term here." id=aa-search-input></div></form></div></div></div></header><main class="container mb-3"><nav aria-label=breadcrumb><ol class="breadcrumb bg-transparent pl-0"><li class=breadcrumb-item><a href=/>Home</a></li><li class=breadcrumb-item><a href=/headquarters/>Headquarters</a></li><li class=breadcrumb-item><a href=/headquarters/config/>Setup and Configuration</a></li><li class="breadcrumb-item active" aria-current=page>AWS setup</li></ol></nav><div class=mb-4><article class="article d-block w-100"><div class="mb-5 pb-1 d-block w-100 page-title d-flex align-items-end"><h2 class="mb-3 mr-auto pr-3">AWS setup</h2><div class="data text-right">December 18, 2020</div></div><div class=article-content><h1 id=installation-of-survey-solutions-on-amazon-aws>Installation of Survey Solutions on Amazon AWS</h1><p>The installation consists of the following steps:</p><ol><li><a href=#create-security-group>Create security group</a> for web server and RDS to be able to communicate</li><li><a href=#create-PostgreSQL-RDS-instance>Create PostgreSQL instance</a></li><li><a href=#create-ec2-instance>Create EC2 instance</a> for running Survey Solutions</li><li><a href=#survey-solutions-installation>Install Survey Solutions</a></li></ol><h2 id=create-security-group>Create security group</h2><p>In order to have connection between Survey Solutions and PostgreSQL you can create new security group as described in <a href=https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.Scenarios.html>here</a>.</p><p>From the AWS Management Console:</p><ul><li>Click on <code>EC2</code> under the <code>Compute</code> heading</li><li>Scroll down the left-hand navigation to <code>Network & Security</code></li><li>Click on <code>Security Groups</code></li><li>Click on <code>Create security group</code></li></ul><p>In the create security group specify name and description:</p><p><img src=images/create_sg.png alt="Create Security Group"></p><p>In the rules page add single required rule:</p><ul><li><strong>Type</strong>: PostgreSQL</li><li><strong>Source</strong>: Start typing &ldquo;Survey Solutions&rdquo; and select just created security group
<img src=images/sg_pg_rule.png alt="Security Group Rules"></li></ul><h2 id=create-postgresql-rds-instance>Create PostgreSQL RDS instance</h2><p>Create an RDS PostgreSQL instance using <a href=https://aws.amazon.com/getting-started/tutorials/create-connect-postgresql-db>this documentation</a>, you don&rsquo;t need to install a database client, but it can be used to test the database connection.</p><p>During creation process expand <em>Additional connectivity configuration</em> section and assign created &ldquo;Survey Solutions&rdquo; security group
<img src=images/rds_sg_selection.png alt="Security Group Rules"></p><p>Keep database port to be default one (5432)</p><p>After database is started copy endpoint address
<img src=images/rds_endpoint.png alt="PostgreSQL endpoint"></p><p>Be sure to retain the following information for accessing the PostgreSQL:</p><ul><li>login</li><li>password</li><li>endpoint</li></ul><p>These details will be needed in a later step to connect the RDS with the EC2 instance.</p><p>To find the endpoint:</p><ul><li>Navigate to <code>RDS</code> from the Amazon Management Console</li><li>Click on <code>DB Instances</code> under <code>Resources</code> in the main pane</li><li>Click on the RDS instance DB identifier of the desired RDS</li><li>Click on the <code>Connectivity & security</code> tab</li><li>Copy the endpoint under <code>Endpoint & port</code></li></ul><h2 id=create-ec2-instance>Create EC2 instance</h2><ul><li>In the services list Compute section select EC2</li><li>Find &ldquo;Launch instance menu&rdquo;
<img src=images/ec2_launch.png alt="Image selection"></li><li>In search bar type &ldquo;Windows&rdquo;</li><li>Select Microsoft Windows Server 2019 Base
<img src=images/ec2_image_selection.png alt="Image selection"></li><li>In tier selection pick one that suites your needs. You can <a href=/faq/server-requirements/>check for server requirements here</a>.</li><li>After instance is created right click on it, select Networking -> Change Security Groups and assign group Survey Solutions
<img src=images/ec2_sg_assign.png alt="Assign Security Group"></li><li>Launch selected instance</li></ul><h2 id=survey-solutions-installation>Survey Solutions installation</h2><h3 id=connect-to-the-ec2-instance>Connect to the EC2 instance</h3><p>When your instance is running, connect to it with RDP <a href=https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/connecting_to_windows_instance.html>using instructions</a>.</p><h3 id=download-survey-solutions-installer>Download Survey Solutions installer</h3><p>Once connected, download the Survey Solutions installer. Before doing so, you may need to change the security settings of Internet Explorer (IE) on the EC2 instance to make download possible. To do so:</p><ul><li>Open IE</li><li>Navigate to Settings>Internet>Security>Trusted Sites</li><li>Add <code>https://mysurvey.solutions</code> as a trusted site</li><li>Reduce the security level for this zone to <code>Medium-low</code></li><li>Click <code>Apply</code> and <code>OK</code></li></ul><p>To download the Survey Solutions installer:</p><ul><li>Navigate to <a href=https://mysurvey.solutions/Download>installer download page</a> in a browser outside of the RDP connection</li><li>Right-click the <code>DOWNLOAD</code> button</li><li>Select <code>Copy link address</code></li><li>Paste the link into the address bar of IE in the RDP connection in order to download the installation file on the EC2 instance</li></ul><h3 id=install-survey-solutions>Install Survey Solutions</h3><p>Once the installer is downloaded, perform these <a href=https://docs.mysurvey.solutions/headquarters/config/server-installation/#installing-surveysolutions>installation</a> steps (skip PostgreSQL part). When asked for the database connection, enter the endpoint from RDS setup and database credentials.</p><h3 id=change-port-from-9700-to-80>Change port from 9700 to 80</h3><p>Delete default web site from IIS web sites list and add :80 port binding to Survey Solutions web site:</p><ol><li>Right-click on <code>start menu</code> -> <code>run</code></li><li>Execute <code>inetmgr</code> to start IIS manager</li><li>Look in the left-hand <code>Connections</code> panel</li><li>Expand the entry</li><li>Expand <code>Sites</code></li><li>Right-click on <code>Default Web Site</code> and select <code>remove</code></li><li>Select Survey Solutions site</li><li>In the right panel under <code>Edit Site</code>, click on <code>Bindings</code></li><li>Select the existing site binding</li><li>Change <code>Port</code> from 9700 to 80</li><li>Leave host name empty for now</li></ol><h3 id=expose-80-port-to-external-users>Expose 80 port to external users</h3><ul><li>In the AWS console EC2 running instances find security group where only web server is included (for me it is &ldquo;launch-wizard-1&rdquo;):
<img src=images/ec2_sg_web.png alt="Open 80 port security group"></li><li>Navigate to Network & Security -> Security Groups in the left panel</li><li>Find group of the web server and click on it</li><li>Click Edit Inbound Rules</li><li>Add Rule<ul><li><strong>Type</strong>: HTTP</li><li><strong>Select</strong>: <code>0.0.0.0/0</code> as Source</li></ul></li><li>Save rules</li></ul><p>In Survey Solutions installation location <code>Site</code> folder find <code>appsettings.production.ini</code> file, and remove <code>:9700</code> from <code>BaseUrl</code>.</p><p>When done correctly you should be able to access Survey Solutions application from your browser by using public DNS:
<img src=images/ec2_public_dns.png alt="Public DNS EC2"></p><p>Copy value from your console to browser address bar:
<img src=images/ec2_ss_running.png alt="Testing connection"></p><h3 id=dns-and-ssl>DNS and SSL</h3><p>Also we recommend enabling public DNS name for your survey solutions instance. Choose any DNS registrar you like, or maybe you already have domain name. When it is resolved to public IP address of Amazon EC2 instance change <code>BaseURL</code> setting in <code>appsettings.production.ini</code> file. If SSL is used, set <code>BaseUrl</code> to <code>https://%your dns name%</code>.</p><h3 id=s3-configuration>S3 Configuration</h3><p>Survey Solutions can store multimedia data (images, audio audit, etc) in <a href=https://aws.amazon.com/s3/>Amazon S3 storage</a> to reduce load on database instance.</p><p>In order to enable S3 storage open S3 service console and create new bucket (you will need to pick name according to <a href=https://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html>naming rules</a>):
<img src=images/new-bucket.png alt="Bucket creation"></p><p>Now to enable Survey Solutions access to that bucket new IAM role will be required. In order to create it in services list find IAM, then go to <code>Roles</code>-><code>Create new role</code>:
<img src=images/create-role.png alt="Role creation"></p><p>Provide name, and attach appropriate policy:
<img src=images/s3-access.png alt="Role creation"></p><p>In order to attach this role to EC2 instance open EC2 console, find the appropriate image and select <code>Attach/Replace IAM role</code>:
<img src=images/attach-role.png alt="Attach role">
Then select the created role:
<img src=images/attach-role-name.png alt="Attach role. Role selection"></p><p>In Survey Solutions installation location <code>Site</code> folder find <code>appsettings.production.ini</code> file.</p><ol><li>Change storage options. In configuration file replace <code>AppData</code> key value to <code>AppData=s3://%Your bucket name%/survey-solutions</code></li><li>Add section with region configuration (use same region as your S3 bucket)</li></ol><p>Your configuration file should contain such configuration:</p><div class=highlight><pre style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#00f>[FileStorage]</span>
AppData=<span style=color:#a31515>s3://%Your bucket name%/survey-solutions</span>
TempData=<span style=color:#a31515>..\Data_Site</span>
<span style=color:#00f>[AWS]</span>
Region=<span style=color:#a31515>us-east-1 # replace with your region</span>
</code></pre></div><p>Restart Windows image for changes to take effect.</p><p>Survey Solutions will create folder with configured tenant name where it will store the binary data for the interviews.</p></div></article></div></main><footer class="footer pt-3 pb-1 px-sm-3 px-lg-0"><div class="container copyright"><div class=float-left>&#169; 2016-2021 The World Bank Group.<br>All rights Reserved. <a href=https://www.worldbank.org/en/about/legal _target=blank>Legal</a><br><a class=text-primary href=/about/ _target=blank><b class=text-primary>About the team</b></a>
<a class=text-primary href=http://www.capterra.com/p/153927/Survey-Solutions/ target=_blank>Testimonials</a></div></div></footer><script src=https://code.jquery.com/jquery-3.3.1.min.js integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/algoliasearch/3/algoliasearch.min.js></script><script src=https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.min.js></script><script src=/js/asearch.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/ekko-lightbox/5.3.0/ekko-lightbox.min.js></script><script>$(document).on('click','[data-toggle="lightbox"]',function(a){a.preventDefault(),$(this).ekkoLightbox({alwaysShowClose:!0})})</script></body></html>